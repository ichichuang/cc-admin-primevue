# GitHub Actions é…ç½®æ–‡ä»¶
# å®šä¹‰å·¥ä½œæµä¸­ä½¿ç”¨çš„ç¯å¢ƒå˜é‡å’Œé…ç½®

# ç¯å¢ƒå˜é‡é…ç½®
env:
  # Node.js ç‰ˆæœ¬
  NODE_VERSION: '22.x'

  # pnpm ç‰ˆæœ¬
  PNPM_VERSION: '10.12.4'

  # é¡¹ç›®é…ç½®
  PROJECT_NAME: 'cc-admin'
  PROJECT_VERSION: '0.0.0'

  # æ„å»ºé…ç½®
  BUILD_TARGET: 'es2015'
  BUILD_SOURCEMAP: 'false'

  # ç¼“å­˜é…ç½®
  CACHE_KEY_PREFIX: 'cc-admin'

  # éƒ¨ç½²é…ç½®
  DEPLOY_PLATFORM: 'vercel'

  # é€šçŸ¥é…ç½®
  NOTIFICATION_ENABLED: 'true'

# åˆ†æ”¯é…ç½®
branches:
  main: 'main'
  develop: 'develop'
  feature: 'feature/*'
  hotfix: 'hotfix/*'
  release: 'release/*'

# ç¯å¢ƒé…ç½®
environments:
  development:
    name: 'development'
    url: 'https://dev.cc-admin.com'

  staging:
    name: 'staging'
    url: 'https://staging.cc-admin.com'

  production:
    name: 'production'
    url: 'https://cc-admin.com'

# æ„å»ºé…ç½®
build:
  # æ„å»ºå‘½ä»¤
  commands:
    install: 'pnpm install --frozen-lockfile'
    build: 'pnpm build'
    test: 'pnpm test'
    lint: 'pnpm lint'
    type-check: 'pnpm type-check'
    naming-check: 'pnpm naming-check'
    env-check: 'pnpm env-check'

  # æ„å»ºäº§ç‰©
  artifacts:
    - name: 'dist'
      path: 'dist/'
      retention-days: 7
    - name: 'build-analysis'
      path: 'dist/stats.html'
      retention-days: 30

# æµ‹è¯•é…ç½®
test:
  # æµ‹è¯•å‘½ä»¤
  commands:
    unit: 'pnpm test:unit'
    e2e: 'pnpm test:e2e'
    coverage: 'pnpm test:coverage'

  # è¦†ç›–ç‡é…ç½®
  coverage:
    threshold: 80
    format: 'lcov'

# ä»£ç è´¨é‡é…ç½®
quality:
  # æ£€æŸ¥å‘½ä»¤
  commands:
    eslint: 'pnpm lint'
    prettier: 'pnpm format --check'
    typescript: 'pnpm type-check'
    naming: 'pnpm naming-check'

  # è§„åˆ™é…ç½®
  rules:
    eslint: 'error'
    prettier: 'error'
    typescript: 'error'
    naming: 'error'

# éƒ¨ç½²é…ç½®
deploy:
  # å¹³å°é…ç½®
  platforms:
    vercel:
      action: 'amondnet/vercel-action@v25'
      args: '--prod'

  # ç¯å¢ƒå˜é‡
  env:
    development:
      VITE_APP_ENV: 'development'
      VITE_API_BASE_URL: 'https://dev-api.cc-admin.com'

    staging:
      VITE_APP_ENV: 'staging'
      VITE_API_BASE_URL: 'https://staging-api.cc-admin.com'

    production:
      VITE_APP_ENV: 'production'
      VITE_API_BASE_URL: 'https://api.cc-admin.com'

# é€šçŸ¥é…ç½®
notifications:
  # æˆåŠŸé€šçŸ¥
  success:
    message: 'âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼'
    details:
      - 'ğŸ“¦ æ„å»ºæˆåŠŸ'
      - 'ğŸ”’ å®‰å…¨æ‰«æé€šè¿‡'
      - 'ğŸ§ª æµ‹è¯•é€šè¿‡'

  # å¤±è´¥é€šçŸ¥
  failure:
    message: 'âŒ æ£€æŸ¥å¤±è´¥ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—'
    details:
      - 'ğŸ” ä»£ç è´¨é‡: {result}'
      - 'ğŸ—ï¸ æ„å»ºæµ‹è¯•: {result}'
      - 'ğŸ”’ å®‰å…¨æ‰«æ: {result}'

# ç¼“å­˜é…ç½®
cache:
  # pnpm ç¼“å­˜
  pnpm:
    path: '${{ env.STORE_PATH }}'
    key: '${{ runner.os }}-pnpm-store-${{ hashFiles("**/pnpm-lock.yaml") }}'
    restore-keys:
      - '${{ runner.os }}-pnpm-store-'

  # æ„å»ºç¼“å­˜
  build:
    path: 'node_modules/.cache'
    key: '${{ runner.os }}-build-${{ hashFiles("**/*.{ts,tsx,vue,js,jsx}") }}'
    restore-keys:
      - '${{ runner.os }}-build-'

# å®‰å…¨é…ç½®
security:
  # æ‰«æå‘½ä»¤
  commands:
    audit: 'pnpm audit --audit-level moderate'
    snyk: 'snyk test'

  # è§„åˆ™é…ç½®
  rules:
    audit_level: 'moderate'
    fail_on_vulnerability: true

# å‘å¸ƒé…ç½®
release:
  # ç‰ˆæœ¬æ ¼å¼
  version_format: 'v*'

  # å˜æ›´æ—¥å¿—é…ç½®
  changelog:
    template: |
      ## ğŸš€ æ–°ç‰ˆæœ¬å‘å¸ƒ

      ### ğŸ“‹ å˜æ›´å†…å®¹
      {changelog}

      ### ğŸ“¦ æ„å»ºä¿¡æ¯
      - ç‰ˆæœ¬: {version}
      - æäº¤: {commit}
      - æ—¶é—´: {timestamp}

      ### ğŸ”§ æŠ€æœ¯æ ˆ
      - Vue 3.5+
      - TypeScript 5+
      - Vite 7+
      - UnoCSS
      - Pinia

      ### ğŸ“ æ›´æ–°æ—¥å¿—
      è¯·æŸ¥çœ‹ [CHANGELOG.md](docs/CHANGELOG.md) è·å–è¯¦ç»†æ›´æ–°ä¿¡æ¯ã€‚

  # æ–‡æ¡£æ›´æ–°
  docs:
    changelog_file: 'docs/CHANGELOG.md'
    commit_message: 'docs: update changelog for {version}'
